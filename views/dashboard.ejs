<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0d6efd">
    <!-- Bootstrap -->

    <link href="/stylesheets/bootstrap.css" rel="stylesheet" type="text/css">
    <link rel='stylesheet' type="text/css" href='/stylesheets/style.css' />

    <link href="/stylesheets/bootstrap-grid.css" rel="stylesheet" type="text/css">
    <!-- <script src="https://kit.fontawesome.com/794501ab65.js" crossorigin="anonymous"></script> -->
    <link rel='stylesheet' href='/stylesheets/lib.css' />

    <!-- Font awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous" />
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
    <title>Document</title>

    <style>
        form .requiredX {
            position: relative;
            top: 5px;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-light fixed-top py-0 shadow">
        <div class=" container ps-lg-5">
            <a class="text-30 navbar-brand text-primary " href="/ ">
                   Yowa Music
               </a>
            <button class="navbar-toggler ml-20" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
 <span class="navbar-toggler-icon"></span>
</button>
            <div class="collapse justify-content-end navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ">
                    <li class="nav-item text-20">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                    <li class="nav-item text-20">
                        <a class="nav-link" aria-current="page" href="/songs">Songs</a>
                    </li>
                    <li class="nav-item text-20">
                        <a class="nav-link" href="/gallery">Gallery</a>
                    </li>
                    <li class="nav-item text-20 ms-md-5">
                        <a class="nav-link active" href="#"> <button type="button" id="adminName" class="btn bg-pink shadow"> <i class="fas fa-user"> <%= name %></i>  </button> </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <main class="d-flex flex-row ">
        <section class="">

            <div class="containe d-flex">
                <div class="d-flex mt-5 justify-content-center position-fixed shadow" style="width: 380px; left:0px;">
                    <div class="user  mt-5">
                        <img src="https://res.cloudinary.com/remilekunelijah/image/upload/v1614467615/wordpress/elijah_98807206.png" alt="" class=" mx-auto border-rounded border-0 shadow bg-dark mb-3" srcset="" style="width: 200px;">

                        <div class="d-flex align-items-center">
                            <li class="fas fa-user text-25 text-center" style="margin-top: -9px; margin-right: 10px;"></li>
                            <h2 class="ml-2 text-25">
                                <%= data.name%>
                            </h2>
                        </div>
                        <div class="d-flex align-items-center">
                            <li class="far fa-envelope text-25 text-center" style="margin-top: -9px; margin-right: 10px;"></li>
                            <h2 class="ml-2 text-20 email">
                                <%= data.email %>
                            </h2>
                        </div>

                        <div class="mt-5 pb-2">
                            <h3 class="text-danger">Danger Area</h3>
                            <div class="border border-2 p-2" style="border-radius: 5px;">
                                <p class="text-23 mb-0">Log out of your account</p>
                                <button class="btn btn-outline-danger mb-3 border border-danger">Logout</button>
                                <p class="text-23 mb-0">Delete your account</p>
                                <button class="btn btn-danger">Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="ms-auto" style="width: 70%">
            <div class="d-flex justify-content-center  mt-100" style="margin-right: 1">

                <div class="d-flex  flex-row justify-content-center">


                    <div class=" bg-danger text-center text-white py-2 col-4 card shadow border-0">
                        <h4 class="text-23">Songs uploaded </h4>
                        <span class="text-30 text-bold">6</span>
                    </div>

                    <div class="bg-dark text-center text-white py-2 col-3 card shadow ms-3 border-0">
                        <h4 class="text-23">Total Songs </h4>
                        <span class="text-30">10</span>
                    </div>

                    <div class="bg-warning text-center text-white py-2 col-3 card shadow mx-3 border-0">
                        <h4 class="text-23">Total videos </h4>
                        <span class="text-30">3</span>
                    </div>

                    <div class=" bg-primary text-center text-white py-2 col-4 card shadow border-0">
                        <h4 class="text-23">Videos uploaded </h4>
                        <span class="text-30 text-bold">2</span>
                    </div>
                </div>
            </div>

            <article class="mt-5 mb-5 pb-5">
                <form action="/admin/:email/upload" method="post" class="d-flex justify-content-center" enctype="multipart/form-data">
                    <fieldset class="mt-4">
                        <h1 class="mb-5 text-center">Upload new file</h1>

                        <div class="form-group d-flex justify-content-center">
                            <div class="w-60" style="margin-right: 10px !important">
                                <label for="file" class="text-20">File to upload <span class="requiredX text-danger">*</span></label>
                                <input type="file" placeholder="upload something" name="file" class="form-control" id="file" required>
                            </div>
                            <div class="w-50">
                                <label for="ftype" class="text-20">File type <span class="requiredX text-danger">*</span></label>
                                <select name="ftype" class="form-control" id="ftype" required>
                             <option disabled selected>File Type</option>
                             <option value="Audio">Audio</option>
                             <option value="Video">Video</option>
                             <option value="Image">Image</option>
                            </select>
                            </div>
                        </div>

                        <div class="form-group d-flex justify-content-center mt-4">
                            <div class="w-60" style="margin-right: 10px !important">
                                <label for="fname" class="text-20">File name <span class="requiredX text-danger">*</span></label>
                                <input type="text" placeholder="e.g Yowa - down on" name="fname" class="form-control" id="fname">
                            </div>
                            <div class="w-50">
                                <label for="xlink" class="text-20">External link </label>
                                <input type="text" placeholder="e.g https://audiomack.com/yowa_music/song/down-on-me" class="form-control" id="xlink" name="exLink">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-danger mt-4 form-control text-20">Upload File</button>
                    </fieldset>
                </form>

            </article>

            <!-- Songs From DB -->
            <% song.forEach( s => {%>

                <div class="song row justify-content-center align-items-center mb-5 mt-5">
                    <h4 class="col-sm-4">

                        <bold class="text-primary">
                            <%=s.name%>
                        </bold>
                    </h4>
                    <div class="track col-sm-10 col-md-7 d-flex flex-xs-column align-items-center justify-content-around">
                        <audio controls class="px-xs-5"><source src=" <%= s.path %> " type='audio/mp3'></audio>
                        <div class="d-flex justify-content-between mt-xs-15" style="width: 120px;">
                            <a class="px-1 px-lg-0" href="<%= s._id %>"><img src="/images/audiomack.png" alt="" srcset="" style="height: 20px; width: 40px;"></a>
                            <a href="<%=s.path%>" download>
                                <button type="submit" class="btn bg-pink fa fa-download py-2"></button>
                            </a>
                        </div>
                    </div>

                </div>
                <% })%>
        </section>
    </main>
    <script>
        const uri = document.querySelector("form").getAttribute("action");
        console.log(document.location.href + uri);

        // alert()
        document.querySelector("form").addEventListener("submit", e => {
            // e.preventDefault();
            const url = document.location.href + uri;
            console.log($(e)[0].target.file.value);

            let info = {
                file: {
                    file: $(e)[0].target.file.value
                },
                ftype: $(e)[0].target.ftype.value,
                fname: $(e)[0].target.fname.value,
                exlink: $(e)[0].target.exLink.value,
            };
            console.log(info);
            try {
                $.ajax({
                    type: "POST",
                    url: url,
                    data: info,
                    success: (data) => {
                        alert("sucess")
                    },
                    error: (err) => {
                        console.log("Error:", err);
                    },
                    dataType: "json"
                })
            } catch (err) {
                console.log(err)
            };
        });
        //
    </script>
    <script src="javascripts/bootstrap.min.js"></script>
    <script src="javascripts/app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" type="text/javascript"></script>
    <script src="javascripts/jquery.min.js"></script>

</body>

</html>